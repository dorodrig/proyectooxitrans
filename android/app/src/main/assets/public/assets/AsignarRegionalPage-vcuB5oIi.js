import{r as l,u as j,c as d,d as b,b as E,j as e}from"./index-6Tc4nVY8.js";import{u as U}from"./useMutation-BcgxUEpT.js";import{r as V}from"./regionalesService-p9LX0T1s.js";const w=()=>{const[o,u]=l.useState(""),[a,g]=l.useState(null),[t,v]=l.useState(""),[f,D]=l.useState("planta"),[x,m]=l.useState(null),h=j(),{data:c,isLoading:A}=d({queryKey:["buscar-usuario",o],queryFn:()=>b.buscar(o),enabled:o.length>2});function R(n){return typeof n=="object"&&n!==null&&"data"in n&&Array.isArray(n.data)}function N(n){return Array.isArray(n)?n.filter(s=>typeof s=="object"&&s!==null&&"id"in s):[]}let i=[];Array.isArray(c)?i=N(c):R(c)&&(i=N(c.data));let r=i;o.length>2&&i.length>0&&(/^\d{6,}$/.test(o.trim())?r=i.filter(s=>s.documento===o.trim()):r=i.filter(s=>`${s.nombre} ${s.apellido}`.toLowerCase().includes(o.trim().toLowerCase())||s.documento.includes(o.trim())));const p=U({mutationFn:async()=>{if(!a||!t)throw new Error("Faltan datos");return b.asignarRegionalYTipo(a.id,t,f)},onSuccess:()=>{m("Regional y tipo asignados correctamente"),h.invalidateQueries({queryKey:["usuarios"]})},onError:n=>{n instanceof Error?m(n.message):m("Error al asignar regional")}}),C=E(),{data:y=[]}=d({queryKey:["regionales"],queryFn:async()=>(await(await fetch("/api/regionales")).json()).data||[]});return e.jsxDEV("div",{className:"asignar-regional-usuario p-4 bg-white rounded shadow max-w-xl mx-auto",children:[e.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:"Asignar Regional y Tipo de Usuario"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:95,columnNumber:7},void 0),e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("input",{type:"text",placeholder:"Buscar usuario por nombre o documento...",value:o,onChange:n=>{u(n.target.value),a&&g(null)},className:"form-input w-full"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:97,columnNumber:9},void 0),A&&e.jsxDEV("div",{children:"Buscando..."},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:107,columnNumber:29},void 0),a?e.jsxDEV("ul",{className:"border rounded mt-2 bg-gray-50",children:e.jsxDEV("li",{className:"p-2 bg-red-400 text-white font-bold rounded",children:[a.nombre," ",a.apellido," - ",a.documento]},a.id,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:110,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:109,columnNumber:11},void 0):Array.isArray(r)&&r.length>0&&e.jsxDEV("ul",{className:"border rounded mt-2 bg-gray-50",children:r.map(n=>e.jsxDEV("li",{className:`p-2 cursor-pointer hover:bg-gray-200 ${a&&a.id===n.id?"bg-gray-300":""}`,onClick:()=>g(n),children:[n.nombre," ",n.apellido," - ",n.documento]},n.id,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:121,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:119,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:96,columnNumber:7},void 0),e.jsxDEV("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxDEV("label",{className:"block mb-1 font-medium",children:"Regional"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:134,columnNumber:9},void 0),e.jsxDEV("button",{type:"button",className:"btn-gestionar-regionales",onClick:()=>C("/admin/regionales"),children:[e.jsxDEV("span",{className:"icon-gear",children:e.jsxDEV("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsxDEV("circle",{cx:"12",cy:"12",r:"3"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:141,columnNumber:156},void 0),e.jsxDEV("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h0a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h0a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v0a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:141,columnNumber:187},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:141,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:140,columnNumber:11},void 0),e.jsxDEV("span",{className:"ml-2 font-semibold",children:"Gestionar Regionales"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:143,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:135,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:133,columnNumber:7},void 0),e.jsxDEV("select",{className:"form-input w-full mb-4",value:t,onChange:n=>v(n.target.value),children:[e.jsxDEV("option",{value:"",children:"Seleccione una regional"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:151,columnNumber:9},void 0),y.map(n=>e.jsxDEV("option",{value:n.id,children:n.nombre},n.id,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:153,columnNumber:11},void 0))]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:146,columnNumber:7},void 0),e.jsxDEV("div",{className:"mb-4",children:[e.jsxDEV("label",{className:"block mb-1 font-medium",children:"Tipo de Usuario"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:158,columnNumber:9},void 0),e.jsxDEV("select",{className:"form-input w-full",value:f,onChange:n=>D(n.target.value),children:[e.jsxDEV("option",{value:"planta",children:"Planta"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:164,columnNumber:11},void 0),e.jsxDEV("option",{value:"visita",children:"Visita"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:165,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:159,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:157,columnNumber:7},void 0),e.jsxDEV("button",{className:"btn-primary w-full",disabled:!a||!t||p.isPending,onClick:()=>p.mutate(),children:"Asignar Regional y Tipo"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:168,columnNumber:7},void 0),x&&e.jsxDEV("div",{className:"mt-2 text-center text-green-700",children:x},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:175,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/components/AsignarRegionalUsuario.tsx",lineNumber:94,columnNumber:5},void 0)},P=()=>{const{data:o,isLoading:u}=d({queryKey:["regionales"],queryFn:()=>V.getAll()});return e.jsxDEV("div",{className:"asignar-regional-page max-w-2xl mx-auto py-8",children:[e.jsxDEV("h1",{className:"text-2xl font-bold mb-6 text-oxitrans-red",children:"Asignar Regional y Tipo de Usuario"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRegionalPage.tsx",lineNumber:16,columnNumber:7},void 0),u?e.jsxDEV("div",{children:"Cargando regionales..."},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRegionalPage.tsx",lineNumber:18,columnNumber:9},void 0):e.jsxDEV(w,{regionales:o||[]},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRegionalPage.tsx",lineNumber:20,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRegionalPage.tsx",lineNumber:15,columnNumber:5},void 0)};export{P as default};
