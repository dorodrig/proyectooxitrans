import{r as o,u as j,b as C,c as E,j as e,d}from"./index-6Tc4nVY8.js";import{u as P}from"./useMutation-BcgxUEpT.js";const V=["admin","empleado","supervisor"],Q=()=>{const[l,g]=o.useState(""),[i,N]=o.useState(""),[n,c]=o.useState(null),[a,t]=o.useState(""),[u,r]=o.useState(null),x=j(),f=C(),{data:p,isLoading:v,error:b}=E({queryKey:["usuarios",i],queryFn:()=>d.getAll(1,50,i)}),m=p?.data?.usuarios||[],D=P({mutationFn:async({usuarioId:s,nuevoRol:A})=>await d.asignarRol(s,A),onSuccess:()=>{r("Rol asignado correctamente"),x.invalidateQueries({queryKey:["usuarios"]}),c(null),t("")},onError:s=>{s instanceof Error?r(s.message):r("Error al asignar el rol")}}),h=s=>{s.preventDefault(),N(l)},R=()=>{if(!n||!a){r("Selecciona usuario y rol");return}console.log("[AsignarRol] usuarioId:",n.id,"rol:",a),D.mutate({usuarioId:n.id,nuevoRol:a})};return e.jsxDEV("div",{className:"asignar-roles-page",children:e.jsxDEV("div",{className:"asignar-roles-container",children:[e.jsxDEV("h1",{children:"Asignar Roles a Usuarios"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:58,columnNumber:9},void 0),e.jsxDEV("form",{onSubmit:h,className:"search-form",children:[e.jsxDEV("input",{type:"text",placeholder:"Buscar por nombre o documento...",value:l,onChange:s=>g(s.target.value),className:"search-input"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:60,columnNumber:11},void 0),e.jsxDEV("button",{type:"submit",children:"Buscar"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:67,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:59,columnNumber:9},void 0),u&&e.jsxDEV("div",{className:"mensaje",children:u},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:69,columnNumber:21},void 0),e.jsxDEV("div",{className:"tabla-usuarios",children:v?e.jsxDEV("p",{className:"mensaje",children:"Cargando usuarios..."},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:72,columnNumber:13},void 0):b?e.jsxDEV("p",{className:"mensaje error",children:"Error al cargar usuarios"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:74,columnNumber:13},void 0):e.jsxDEV("table",{children:[e.jsxDEV("thead",{children:e.jsxDEV("tr",{children:[e.jsxDEV("th",{children:"Nombre"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:79,columnNumber:19},void 0),e.jsxDEV("th",{children:"Documento"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:80,columnNumber:19},void 0),e.jsxDEV("th",{children:"Rol Actual"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:81,columnNumber:19},void 0),e.jsxDEV("th",{children:"Seleccionar"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:82,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:78,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:77,columnNumber:15},void 0),e.jsxDEV("tbody",{children:m.length>0?m.map(s=>e.jsxDEV("tr",{className:n?.id===s.id?"seleccionado":"",children:[e.jsxDEV("td",{children:[s.nombre," ",s.apellido]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:89,columnNumber:23},void 0),e.jsxDEV("td",{children:s.documento},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:90,columnNumber:23},void 0),e.jsxDEV("td",{className:"capitalize",children:s.rol},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:91,columnNumber:23},void 0),e.jsxDEV("td",{children:e.jsxDEV("button",{className:"seleccionar-btn",onClick:()=>c(s),disabled:n?.id===s.id,children:"Seleccionar"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:93,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:92,columnNumber:23},void 0)]},s.id,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:88,columnNumber:21},void 0)):e.jsxDEV("tr",{children:e.jsxDEV("td",{colSpan:4,className:"mensaje",children:"No se encontraron usuarios"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:105,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:104,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:85,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:76,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:70,columnNumber:9},void 0),n&&e.jsxDEV("div",{className:"asignar-rol-form",children:[e.jsxDEV("div",{children:["Asignar nuevo rol a ",e.jsxDEV("span",{className:"usuario-nombre",children:[n.nombre," ",n.apellido]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:115,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:114,columnNumber:13},void 0),e.jsxDEV("select",{value:a,onChange:s=>t(s.target.value),children:[e.jsxDEV("option",{value:"",children:"Selecciona un rol"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:121,columnNumber:15},void 0),V.map(s=>e.jsxDEV("option",{value:s,children:s},s,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:123,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:117,columnNumber:13},void 0),e.jsxDEV("button",{type:"button",onClick:R,children:"Asignar Rol"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:126,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:113,columnNumber:11},void 0),e.jsxDEV("button",{className:"volver-btn",onClick:()=>f("/admin/usuarios"),children:"Volver a Administraci√≥n de Usuarios"},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:129,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:57,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Development/oxitrans-control-acceso/src/pages/AsignarRolesPage.tsx",lineNumber:56,columnNumber:5},void 0)};export{Q as default};
